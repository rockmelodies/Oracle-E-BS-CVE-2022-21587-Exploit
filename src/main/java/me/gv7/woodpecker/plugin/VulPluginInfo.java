package me.gv7.woodpecker.plugin;

import me.gv7.woodpecker.plugin.exploits.CVE_2022_21587_Command_Execution;
import me.gv7.woodpecker.plugin.exploits.CVE_2022_21587_Zip_Upload;
import me.gv7.woodpecker.plugin.payloads.CVE_2022_21587_Payload;
import java.util.ArrayList;
import java.util.List;

public class VulPluginInfo implements IVulPlugin {

    public static IVulPluginCallbacks callbacks;
    public static IPluginHelper pluginHelper;

    @Override
    public void VulPluginMain(IVulPluginCallbacks callbacks) {

        VulPluginInfo.callbacks = callbacks;
         pluginHelper = callbacks.getPluginHelper();
        callbacks.setVulPluginName("Oracle E-BS CVE-2022-21587 Exploit");
        callbacks.setVulPluginAuthor("Zh1z3ven");
        callbacks.setVulId("CVE-2022-21587");
        callbacks.setVulDescription("Oracle E-BS CVE-2022-21587");
        callbacks.setVulName("Oracle E-BS unCompress RCE");
        callbacks.setVulDisclosureTime("2022-10");
        callbacks.setVulCVSS(9.8);
        callbacks.setVulSeverity(callbacks.VUL_CATEGORY_RCE);
        callbacks.setVulProduct("Oracle");
        callbacks.setVulDescription("12.2.3-12.2.11");

        List<IExploit> exploitList = new ArrayList<>();
        exploitList.add(new CVE_2022_21587_Command_Execution());
        exploitList.add(new CVE_2022_21587_Zip_Upload());
        callbacks.registerExploit(exploitList);

        List<IPayloadGenerator> payloads = new ArrayList<>();
        payloads.add(new CVE_2022_21587_Payload());
        callbacks.registerPayloadGenerator(payloads);



    }
}
